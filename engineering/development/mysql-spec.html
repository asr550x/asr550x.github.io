<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL 规约 | ASR550x Documents</title>
    <meta name="description" content="description">
    <meta name="keywords" content="huitong handbook">
  <link rel="shortcut icon" href="/images/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.81ed85e0.css" as="style"><link rel="preload" href="/assets/js/app.4f7011c8.js" as="script"><link rel="preload" href="/assets/js/2.e140ca38.js" as="script"><link rel="preload" href="/assets/js/14.eb85eca9.js" as="script"><link rel="prefetch" href="/assets/js/10.9316ec1f.js"><link rel="prefetch" href="/assets/js/11.d7fbd0e0.js"><link rel="prefetch" href="/assets/js/12.a54cc18e.js"><link rel="prefetch" href="/assets/js/13.efa0d79c.js"><link rel="prefetch" href="/assets/js/15.17d0f398.js"><link rel="prefetch" href="/assets/js/16.7e9591e7.js"><link rel="prefetch" href="/assets/js/17.65171f33.js"><link rel="prefetch" href="/assets/js/18.246855ff.js"><link rel="prefetch" href="/assets/js/19.515f09ab.js"><link rel="prefetch" href="/assets/js/20.021170c4.js"><link rel="prefetch" href="/assets/js/21.792b9d60.js"><link rel="prefetch" href="/assets/js/22.1af24f92.js"><link rel="prefetch" href="/assets/js/23.b38abaa4.js"><link rel="prefetch" href="/assets/js/24.2901c080.js"><link rel="prefetch" href="/assets/js/25.9a8b0d68.js"><link rel="prefetch" href="/assets/js/26.9a081eff.js"><link rel="prefetch" href="/assets/js/27.5bc9978d.js"><link rel="prefetch" href="/assets/js/28.60d299a1.js"><link rel="prefetch" href="/assets/js/29.75cb29b3.js"><link rel="prefetch" href="/assets/js/3.dc30cf59.js"><link rel="prefetch" href="/assets/js/30.caa2cdc5.js"><link rel="prefetch" href="/assets/js/31.633e65f5.js"><link rel="prefetch" href="/assets/js/32.f7febcd9.js"><link rel="prefetch" href="/assets/js/33.15fd8506.js"><link rel="prefetch" href="/assets/js/34.9786a883.js"><link rel="prefetch" href="/assets/js/35.36638dd5.js"><link rel="prefetch" href="/assets/js/36.b6954386.js"><link rel="prefetch" href="/assets/js/37.dc50534d.js"><link rel="prefetch" href="/assets/js/38.7eae6c2a.js"><link rel="prefetch" href="/assets/js/39.b352d26d.js"><link rel="prefetch" href="/assets/js/4.a9ddf9ce.js"><link rel="prefetch" href="/assets/js/40.761684ed.js"><link rel="prefetch" href="/assets/js/41.85584ef2.js"><link rel="prefetch" href="/assets/js/42.1b5107de.js"><link rel="prefetch" href="/assets/js/43.3291b41b.js"><link rel="prefetch" href="/assets/js/5.6c4c4122.js"><link rel="prefetch" href="/assets/js/6.36249f79.js"><link rel="prefetch" href="/assets/js/7.07fba0d1.js"><link rel="prefetch" href="/assets/js/8.aa6edea3.js"><link rel="prefetch" href="/assets/js/9.dffbf19f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.81ed85e0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.png" alt="ASR550x Documents" class="logo"> <span class="site-name can-hide">ASR550x Documents</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/company/" class="nav-link">Get started</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/development/mysql-spec.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/engineering/development/mysql-spec.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/asr550x/asr550x.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/company/" class="nav-link">Get started</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/development/mysql-spec.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/engineering/development/mysql-spec.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/asr550x/asr550x.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">ASR550x Documents</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/company/" class="sidebar-heading clickable"><span>Intro</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/people/" class="sidebar-heading clickable"><span>People</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/engineering/" class="sidebar-heading clickable router-link-active"><span>Tech</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/finance/" class="sidebar-heading clickable"><span>Finance</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql-规约"><a href="#mysql-规约" aria-hidden="true" class="header-anchor">#</a> MySQL 规约</h1> <h2 id="建表规约"><a href="#建表规约" aria-hidden="true" class="header-anchor">#</a> 建表规约</h2> <ol><li><p>【强制】表达是与否概念的字段，必须使用 is_xxx 的方式命名，数据类型是 unsigned tinyint ( 1 表示是，0 表示否)，此规则同样适用于 odps 建表。</p> <p>说明:任何字段如果为非负数，必须是 unsigned。</p></li> <li><p>【强制】表名、字段名必须使用小写字母或数字;禁止出现数字开头，禁止两个下划线中间只出现数字。数据库字段名的修改代价很大，因为无法进行预发布，所以字段名称需要慎重考虑。 正例:getter_admin，task_config，level3_name 反例:GetterAdmin，taskConfig，level_3_name</p></li> <li><p>【强制】表名不使用复数名词。</p> <p>说明:表名应该仅仅表示表里面的实体内容，不应该表示实体数量，对应于 DO 类名也是单数 形式，符合表达习惯。</p></li> <li><p>【强制】禁用保留字，如 desc、range、match、delayed 等，参考<a href="https://dev.mysql.com/doc/refman/5.7/en/keywords.html" target="_blank" rel="noopener noreferrer">官方保留字<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></li> <li><p>【强制】唯一索引名为 uk_字段名;普通索引名则为 idx_字段名。
说明:uk_ 即 unique key;idx_ 即 index 的简称。</p></li> <li><p>【强制】小数类型为 decimal，禁止使用 float 和 double。
说明:float 和 double 在存储的时候，存在精度损失的问题，很可能在值的比较时，得到不正确的结果。如果存储的数据范围超过 decimal 的范围，建议将数据拆成整数和小数分开存储。</p></li> <li><p>【强制】如果存储的字符串长度几乎相等，使用 CHAR 定长字符串类型。</p></li> <li><p>【强制】varchar 是可变长字符串，不预先分配存储空间，长度不要超过 5000，如果存储长度 大于此值，定义字段类型为 TEXT，独立出来一张表，用主键来对应，避免影响其它字段索引 效率。</p></li> <li><p>【强制】表必备三字段:id, gmt_created, gmt_updated。</p> <p>说明:其中 id 必为主键，类型为 unsigned bigint、单表时自增、步长为 1; 分表时改为从 id 生成服务取值，确保分表之间的全局唯一。gmt_created, gmt_modified 的类型均为 date_time 类型。</p></li> <li><p>【推荐】表的命名最好是加上“业务名称_表的作用”，避免上云梯后，再与其它业务表关联时有混淆。正例:tiger_task / tiger_reader / mpp_config</p></li> <li><p>【推荐】库名与应用名称尽量一致。</p></li> <li><p>【推荐】如果修改字段含义或对字段表示的状态追加时，需要及时更新字段注释。</p></li> <li><p>【推荐】字段允许适当冗余，以提高性能，但是必须考虑数据同步的情况。冗余字段应遵循:</p> <ol><li>不是频繁修改的字段。</li> <li>不是 varchar 超长字段，更不能是 text 字段。 正例:各业务线经常冗余存储商品名称，避免查询时需要调用 IC 服务获取。</li></ol></li> <li><p>【推荐】单表行数超过 500 万行或者单表容量超过 2GB，才推荐进行分库分表。</p> <p>说明:如果预计三年后的数据量根本达不到这个级别，请不要在创建表时就分库分表。
反例:某业务三年总数据量才 2 万行，却分成 1024 张表，问:你为什么这么设计?答:分 1024 张表，不是标配吗?</p></li> <li><p>【参考】合适的字符存储长度，不但节约数据库表空间、节约索引存储，更重要的是提升检索 速度。</p></li></ol> <p>正例:人的年龄用 unsigned tinyint(表示范围 0-255，人的寿命不会超过 255 岁);海龟就 必须是 smallint，但如果是太阳的年龄，就必须是 int;如果是所有恒星的年龄都加起来，那 么就必须使用 bigint</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/asr550x/asr550x.github.io/edit/master/docs/engineering/development/mysql-spec.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">3/26/2020, 6:13:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/engineering/development/restful-spec.html" class="prev">
          RESTful API 规范
        </a></span> <span class="next"><a href="/engineering/development/ant-vue-spec.html">
          Git ant-vue开发规范
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4f7011c8.js" defer></script><script src="/assets/js/2.e140ca38.js" defer></script><script src="/assets/js/14.eb85eca9.js" defer></script>
  </body>
</html>
